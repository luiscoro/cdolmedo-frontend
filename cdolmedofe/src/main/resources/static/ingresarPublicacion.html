<!DOCTYPE html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <!-- estilos -->
		<meta http-equiv="x-ua-compatible" content="ie=edge">

        <link href="css/estilos.css" rel="stylesheet" type="text/css"/>
        <!--para el login  -->
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
       	<meta name="viewport" content="width=device-width, initial-scale=1">
    	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">

		 <!-- Fuente -->

        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200&display=swap" rel="stylesheet">
        
        <!--  Jquery -->
        <script type="text/javascript" src="jquery/jquery-3.5.0.min.js"></script>
        
		<!--  JS 
	<script src="js/controller.js"></script>
	<script src="js/validar.js"></script>  d-->

        <!-- Botstrap -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
<title>Publicaciones - CDOLMEDO</title>
</head>

<body>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"  ></script>
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"  ></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
	<script src="/js/main.js"></script>
	<!--<script>
	if (typeof localStorage.token === "undefined"){
		window.location.href = "index.html";	
	}
	</script> -->
	
	
	<div class="cabecera"> <!-- Cabecera -->
            <div class="cabeceraLogo">
                <a href="index.html" ><img src="img/escudo.png" ></a>

            </div>
            <div class="cabeceraNombre">
                <a href="index.html">Centro Deportivo<br> <strong>OLMEDO</strong></a>


            </div>
            <div class="cabeceraEsponsor">
                <div class="esponsor">

                    <a href="index.html" target="_blank" ><img src="img/esponsor1.png" ></a>
                </div>
                <div class="esponsor">
                   <a href="index.html" target="_blank" ><img src="img/esponsor4.png" ></a>

                </div>
                <div class="esponsor">
                   <a href="index.html" target="_blank" ><img src="img/esponsor5.jpg" ></a>

                </div>

            </div>

            <div class="cabeceraBoton">
                <button class="botonGeneral" onclick="document.getElementById('login').style.display = 'block'">
                    <strong>CERRAR SESIÓN</strong>
            </button>
            </div>
        </div> <!-- Fin Cabecera -->

	 <div class="barramenu"> <!-- Barra de menú -->
	            <ul class="nav justify-content-center">
	                <li class="nav-item">
	                    <a class="nav-link active" href="#">INICIO</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link" href="#">NOTICIAS</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link" href="#">SERVICIOS</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link" href="#">SOCIO</a>
	                </li>

	                 <li class="nav-item dropdown">
				        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				          PUBLICACIÓN
				        </a>
				        <div class="dropdown-menu" style="background: #2930A6;" aria-labelledby="navbarDropdown">
				          <a class="dropdown-item" href="ingresarPublicacion.html">NUEVA</a>
				          <a class="dropdown-item" href="modificarPublicacion.html">MODIFICAR</a>
				          <a class="dropdown-item" href="eliminarPublicacion.html">ELIMINAR</a>
				          <div class="dropdown-divider"></div>
				          <a class="dropdown-item" href="#">Something else here</a>
				        </div>
				      </li>
				       <li class="nav-item dropdown">
				        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				          INTEGRANTE
				        </a>
				        <div class="dropdown-menu" style="background: #2930A6;" aria-labelledby="navbarDropdown">
				          <a class="dropdown-item" href="ingresarIntegrante.html">NUEVO</a>
				          <a class="dropdown-item" href="modificarIntegrante.html">MODIFICAR</a>
				          <a class="dropdown-item" href="eliminarIntegrante.html">ELIMINAR</a>
				          <div class="dropdown-divider"></div>
				          <a class="dropdown-item" href="#">Something else here</a>
				        </div>
				      </li>

	            </ul>
	        </div> <!-- Fin de barra de menú -->

<header class="page-header header container-fluid">
 <main class="cuerpo_pagina"><!-- CUERPO DE PAGINA -->

			     <div class="cuerporegistro">
			       <form action="#" method="post" enctype="multipart/form-data">
			             <div class="form-group col-md-12">
							<h3 >Ingresar Publicación</h3>
					        	<hr style="background: #FFFFFF;">
						 </div>
						 <div class="form-group col-md-12">
						        	<label>Tipo de Publicación</label><br>
							        	<select name="idTipoPublicacion" id="idTipoPublicacion">
								        	<option value="1">Informativo</option>
								        	<option value="2">Administrativo</option>  
											<option value="3">Noticias</option>
								        	<option value="4">Social</option> 
						        		</select>
					        	<br>
				        		
							</div> 
                            <div class="form-group col-md-12">
                                <label for="nombre" class="col-form-label">Nombre</label>
                                <input type="text"  class="form-control" id="nombre" placeholder="Nombre">
                            </div>
							<div class="form-group col-md-12">
								<label for="detalle" class="col-form-label">Detalle</label>
								<br></br>
                                <textarea class="form-control" id="detalle" rows="3" cols="10	" placeholder="Detalle de Publicación.."></textarea>
                            </div>
							<div class="form-group col-md-12">
                                <label for="nombre" class="col-form-label">Autor</label>
                                <input type="text"  class="form-control" id="autor" placeholder="Autor">
                            </div>
                            <div class="form-group col-md-12">
                                
							</div>
 							<div class="form-group col-md-12">
                            	<label for="name" class="col-form-label">Subir foto</label>
                            	<input type="file" name="file"  accept="image/*" class="form-control"/>
                            </div>


                            <div class="form-group col-md-6">
                                <input type="submit" class="botonGeneral" value="Registrar publicacion" id="addNew">
                            </div>
                        </div>
                    </form>
      </div>


        </main><!--  FIN CUERPO DE PAGINA -->
</head>
	<script>
	$(document).ready(function() {
		$(document).delegate('#addNew', 'click', function(event) {
				event.preventDefault();
				var nombre = $('#nombre').val();
				var detalle = $('#detalle').val();
				var autor = $('#autor').val();
				var idTipoPublicacion = $('#idTipoPublicacion').val();
				//var fecha = $('#fecha').val();

				console.log(nombre);
				console.log(detalle);
				console.log(autor);
				console.log(idTipoPublicacion);
				//console.log(fecha);

				var img = $('input[name="file"]').get(0).files[0];
				console.log(img)

				var formData = new FormData();
				formData.append('img', img);
				var objArr = [];

				objArr.push({"nombre": nombre, "detalle": detalle, "autor": autor, "idTipoPublicacion": idTipoPublicacion});
				console.log(objArr);

				formData.append('publicacion', JSON.stringify( objArr ));
				console.log(formData);

				$.ajax({
					type: "POST",
					//contentType: "application/json; charset=utf-8",
					url: "http://localhost:8080/api/publicacion",
					//data: JSON.stringify({'nombre': nombre, 'detalle': detalle, 'autor': autor, 'idTipoPublicacion': idTipoPublicacion}),
					data: formData,
					cache: false,
					processData:false,
					contentType:false,
					success: function(result) {

						window.location.href = "listarPublicacion.html"; 
					}
				});
		});
	});
	</script>

		<footer ><!-- Footer -->
            <div class="redesolmedo">
                <div class="redes">
                    face
                </div>
            </div>

            <div class="copyright">
                Desarrollado por CODETEAM para CDOLMEDO &copy Riobamba 2020
            </div>
        </footer><!-- FIN footer-->

 <!-- Botstrap -->

</body>
</html>
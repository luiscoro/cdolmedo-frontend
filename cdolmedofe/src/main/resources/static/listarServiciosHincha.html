<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <!-- estilos -->
    <link href="css/estilos.css" rel="stylesheet" type="text/css" />
    <!--para el login  -->
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- Fuente -->

    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200&display=swap" rel="stylesheet">
		<!--  Jquery -->
        <script type="text/javascript" src="jquery/jquery-3.5.0.min.js"></script>

        <!-- Botstrap -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"> <!-- JS -->
        <!-- JS -->
        <script src="/js/main.js"></script>  
    <title>Administrador - CDOLMEDO</title>

</head>

<body>
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script src="/js/main.js"></script>
	<!--<script type="text/javascript">
		var rol = parseInt(localStorage.getItem("idRol"));
		if ((typeof localStorage.id === "undefined") ){
			alert("Acceso no permitido");
			window.location.href = "index.html";	
		}else{
			if(rol !== 3){
				alert("Usuario no permitido");
				window.location.href = "index.html";	
			}
		}
	</script>-->
    <div class="cabecera">
        <!-- Cabecera 1-->
        <div class="cabeceraLogo">
            <a href="index.html"><img src="img/escudo.png"></a>

        </div>
        <div class="cabeceraNombre">
            <a href="index.html">Centro Deportivo<br> <strong>OLMEDO</strong></a>


        </div>
        <div class="cabeceraEsponsor">
            <div class="esponsor">

                <a href="index.html" target="_blank"><img src="img/esponsor1.png"></a>
            </div>
            <div class="esponsor">
                <a href="index.html" ><img src="img/esponsor4.png"></a>

            </div>
            <div class="esponsor">
                <a href="index.html" target="_blank"><img src="img/esponsor5.jpg"></a>

            </div>
        </div>

        <div class="cabeceraBoton">
            <button class="botonGeneral" id="logout">
                <strong>CERRAR SESIÓN</strong>
            </button>
			<div style="margin:0 auto;">
				<a class="nav-link" id="email" href="perfilUsuarioHincha.html" style="color: #FFFFFF;"></a>
				<p>Puntos: <a id="puntos" style="color: #FFFFFF;">0</a></p>
				<script>			
					$(document).ready(function() {		
						var email= localStorage.getItem("mail");
						document.getElementById('email').innerHTML= email;
						//puntos
						if ((typeof localStorage.point === "undefined") ){
							document.getElementById('puntos').innerHTML= "0";	
						}else{
							var puntos= localStorage.getItem("point");
							document.getElementById('puntos').innerHTML= puntos;
						}
						
					});				
				</script> 
			</div>
        </div>
    </div> <!-- Fin Cabecera -->

    <div class="barramenu">
        <!-- Barra de men� -->
        <ul class="nav justify-content-center">
            <li class="nav-item">
                <a class="nav-link active" href="#">INICIO</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">NOTICIAS</a>
            </li>
                 <li class="nav-item dropdown">
				        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				          SERVICIO
				        </a>
				        <div class="dropdown-menu" style="background: #2930A6;" aria-labelledby="navbarDropdown">
				          <a class="dropdown-item" href="listarServiciosHincha.html">LISTAR SERVICIOS</a>
				         <!--  <div class="dropdown-divider"></div>
				          <a class="dropdown-item" href="#">Something else here</a> -->
				        </div>
				      </li>
            <li class="nav-item">
                <a class="nav-link" href="#">SOCIO</a>

            </li>
                 <li class="nav-item dropdown">
				        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				          PUBLICACIÓN
				        </a>
				        <div class="dropdown-menu" style="background: #2930A6;" aria-labelledby="navbarDropdown">
				          <a class="dropdown-item" href="listarPublicacionHincha.html">LISTAR PUBLICACIONES</a>
				         <!--  <div class="dropdown-divider"></div>
				          <a class="dropdown-item" href="#">Something else here</a> -->
				        </div>
				      </li>
				  <li class="nav-item dropdown">
				        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				          JUGADOR
				        </a>
				        <div class="dropdown-menu" style="background: #2930A6;" aria-labelledby="navbarDropdown">
				          <a class="dropdown-item" href="listarJugadoresHincha.html">LISTAR JUGADORES</a>
				        </div>
				      </li>  
        </ul>
    </div> <!-- Fin de barra de men� -->

    <main class="cuerpo_pagina">


        <h2>LISTA DE LOS SERVICIOS</h2>

        <header class="page-header header container-fluid">
            <!-- <main class="cuerpo_pagina"> -->
            <div class="overlay">

                <div class="container my-2">
                    <div class="card-transparent">
                        <div class="card-body rounded" style="background-color: rgba(0, 0, 0, 0.4); ">
                            <table class="table" id="tabla">
                                <tr>
                                    <!--<th>Tipo</th>-->
                                    <th>Tipo de Servicio</th>
                                    <th>Nombre</th>
                                    <th>Estado</th>
                                    <th>Valor</th>
                                    <th>Descuento</th>
                                     <th>Visualizar</th>
                                    <th>Puntos requeridos</th>
									<th>Canjear</th>
									<th>Comprar</th>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!--</main>  -->
        </header>
        <!-- seccion listar en ajax -->
        <script type="text/javascript">
            $(document).ready(function () {
                $.ajax({
                    type: 'GET',
                    url: 'http://localhost:8080/api/servicio',
                    success: function (data) {
						var tr = [];
                        for (var i = 0; i < data.length; i++) {
							var tipos;
							if(data[i].idTipoServicio === 1) {
								tipos="Pagado";
							}else{
								tipos="Gratuito";
							}
							tr.push('<tr>');
							tr.push('<td>' + tipos + '</td>');
                            tr.push('<td>' + data[i].nombre + '</td>');
                            tr.push('<td>' + data[i].estado + '</td>');
                            tr.push('<td>' + data[i].valor + '</td>');
                            tr.push('<td>' + data[i].descuento + '</td>');
                            //tr.push('<td><img src="http://localhost:8080/api/pic/' + data[i].foto + '" width="80" class="rounded"></td>');
                            tr.push('<td>');
                            tr.push('<a data-toggle="modal" data-target="#modalLong' + data[i].id + '" class="btn btn-primary"><img src="img/visualizar.png"></a>');
                            tr.push('<div class="modal fade" tabindex="-1" id="modalLong' + data[i].id + '" role="dialog">');
                            tr.push(' <div class="modal-dialog">');
                            tr.push('	<div class="modal-content">');
                            tr.push('		<div class="modal-header">');
                            tr.push('		  <h5 class="modal-title text-dark">Detalle del Servicio</h5>');
                            tr.push('		  <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">');
                            tr.push('		  	<span aria-hidden="true">&times;</span>');
                            tr.push('		  </button>');
                            tr.push('		</div>');
                            tr.push('		<div class="modal-body">');
                            tr.push('			<h4 class="text-dark">' + '<b>Nombre: </b>' + data[i].nombre + '</h4>');
                            tr.push('           <p><img src="http://localhost:8080/api/pic/' + data[i].foto + '" width="240" class="rounded"></p>');
							tr.push('			<h4 class="text-dark">' + '<b>Costo: $</b>' + data[i].valor + '</h4>');
							tr.push('			<h4 style="color: red">' + '<b style="color: black">Descuento: </b>-' + data[i].descuento + '%</h4>');
                            tr.push('			<p class="text-dark">' + data[i].detalle.replace(/(?:\r\n|\r|\n)/g, '<br>') + '</p>');
                            tr.push('		</div>');
                            tr.push('		<div class="modal-footer">');
                            tr.push('		  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>');
                            tr.push('    	</div>');
                            tr.push('	 </div>');
                            tr.push('	</div>');
                            tr.push(' </div>');
                            tr.push('</td>');
							tr.push('<td style="color: red">' + data[i].canjeo + ' pts</td>');
							tr.push('<td> <a href=canjearConPuntos.html?id=' + data[i].id + ' class="btn btn-primary"><img src="img/canjear.png"></a></td>');
                            tr.push('</td>');
							tr.push('<td> <a href=PagarServicio.html?id=' + data[i].id + ' class="btn btn-primary"><img src="img/pagar.png"></a></td>');
                            tr.push('</td>');
							tr.push('</tr>');
                        }
                        $('#tabla').append($(tr.join('')));
                    },
                });
                $(document).delegate('.borrar', 'click', function () {
                    var id = $(this).attr('id');
                    var parent = $(this).parent().parent();
                    $.ajax({
                        type: "DELETE",
                        url: "http://localhost:8080/api/servicio/" + id,
                        cache: false,
                        success: function () {
                            parent.fadeOut('slow', function () {
                                $(this).remove();
                            });
                            location.reload(true)
                        }
                    });
                });
				
				$('#logout').click(function() {
			      localStorage.clear();
			      window.location.href = "index.html";  
				});
            });
        </script>

    </main>


     <footer ><!-- Footer -->
            <div class="redesolmedo">   
                <div class="redes">
                     <div class="contenedor-redes">
                   	 <img src="img/facebook.png">
                    </div>
                    <div class="contenedor-redes">
                   	 <img src="img/instagram.png">
                    </div>
                    <div class="contenedor-redes">
                   	 <img src="img/youtube.png">
                    </div>
                	<div class="contenedor-redes">
                    	<img src="img/twitter.png">
                    </div>
                    <div class="contenedor-redes">
                    	<img src="img/whatsapp.png">
                    </div>
                </div>            
            </div>
            
            <div class="copyright">
               
                Desarrollado por CODETEAM para CDOLMEDO &copy Riobamba 2020        
            </div>

        </footer><!-- FIN footer-->
		<!-- Botstrap -->      
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>   


</body>

</html>
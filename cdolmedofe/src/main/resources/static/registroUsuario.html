<!DOCTYPE html>

<head>
  		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<!-- estilos -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
        <link href="css/estilos.css" rel="stylesheet" type="text/css"/>
        <!--para el login  -->
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <!-- Fuente -->

        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200&display=swap" rel="stylesheet">
        
        <!--  Jquery -->
		<script type="text/javascript" src="jquery/jquery-3.5.0.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>

        <!-- Botstrap -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" 
              integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" 
              crossorigin="anonymous">

        
		<!--  JS -->
	<script src="js/controller.js"></script>
	<script src="js/validar.js"></script>


<title>Registro Usuario - CDOLMEDO</title>
</head>
<body>

<div class="cabecera"> <!-- Cabecera -->
            <div class="cabeceraLogo">
                <a href="index.html" ><img src="img/escudo.png" ></a>
                 
            </div>
            <div class="cabeceraNombre">
                <a href="index.html">Centro Deportivo<br> <strong>OLMEDO</strong></a>
               
                
            </div>
            <div class="cabeceraEsponsor">
                <div class="esponsor">
            
                    <a href="index.html" target="_blank" ><img src="img/esponsor1.png" ></a>
                </div>
                <div class="esponsor">
                   <a href="index.html" target="_blank" ><img src="img/esponsor4.png" ></a>
                    
                </div>
                <div class="esponsor">
                   <a href="index.html" target="_blank" ><img src="img/esponsor5.jpg" ></a>
                    
                </div>
            </div>
            
            <div class="cabeceraBoton">
                <button class="botonGeneral" onclick="window.location='index.html'">
                    <strong >REGRESAR INICIO</strong> 
            	</button>
            </div>
        </div> <!-- Fin Cabecera1 -->
        
                <div class="barramenu"> <!-- Barra de menú -->
            <ul class="nav justify-content-center">
                <li class="nav-item">
                    <a class="nav-link active" href="#">INICIO</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">NOTICIAS</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">SERVICIOS</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">SOCIO</a>
                    
                </li>
            </ul>  
        </div> <!-- Fin de barra de menú -->
        
  <main class="cuerpo_pagina"><!-- CUERPO DE PAGINA  -->      	   	
     <div class="cuerporegistro">
       <form action="" onsubmit="return valida(this)">
	        	<h3>Registrar Usuario</h3>
	        	<hr style="background: #FFFFFF;">
	        	
	        	<label>Nombre y Apellido</label><br>
	        	<input class="ingresodatos" id="nombre" type="text" placeholder="Nombre.." autofocus="autofocus" ><br><br>
	        	<label>Correo Electrónico</label><br>
	        	<input class="ingresodatos" type="email" id="correo" minlength="8" placeholder="Correo electrónico.."><br><br>
	        	<label>Contraseña</label><br>
	        	<input class="ingresodatos" type="password" min="6" max="16" id="contrasenia" pattern="[A-Za-z][A-Za-z0-9]*[0-9][A-Za-z0-9]" title="Debe empezar con una letra y contener un dijito" placeholder="contraseña.."><br><br>
				<label>Fecha de Nacimiento</label><br>
	        	<input type="date" id="fechaNacimiento" name="fechaNacimiento"
       				value="2010-07-22"
       				min="1920-01-01" max="2030-12-31">        	
	        	
	        	<br><br>
	        	<label>Teléfono</label><br>
	        	<input class="ingresodatos" id="telefono" type="text" pattern="[0-9]" title="Ingresar solo numeros" placeholder="Teléfono.."><br><br>
	        	<label>Dirección</label><br>
	        	<textarea class="ingresodatosdos" id="direccion"  rows="3" cols="39	" placeholder="Dirección.."></textarea>
	        	<br>
	        	<br>
	        	<label>Ubicación</label><br>
	        	<select id="idLocalidad">
	        	<option>País..</option>
	        	   	<option value="1">Ecuador, Riobamba</option>
	        	   	<option value="2">Ecuador, Quito</option>
					<option value="3">Ecuador, Guayaquil</option>
					<option value="4">Ecuador, Ibarra</option>
					<option value="5">Ecuador, Ambato</option>
					<option value="6">Ecuador, Latacunga</option>
					<option value="7">Ecuador, Cuenca</option>
					<option value="8">Ecuador, Sangolquí</option>
					<option value="9">Ecuador, Guaranda</option>
					<option value="10">Ecuador, Tena</option>
					<option value="11">Ecuador, Macas</option>
					<option value="12">Ecuador, Guano</option>
					<option value="13">Ecuador, Penipe</option>
					<option value="14">Ecuador, Alausí</option>
					<option value="15">Ecuador, Chambo</option> 
					<option value="16">Ecuador, Azogues</option>
					<option value="17">Ecuador, Esmeraldas</option>
					<option value="18">Ecuador, Loja</option>
					<option value="19">Ecuador, Manta</option>
					<option value="20">Ecuador, Portoviejo</option>  
	        	</select>
	        	<br>
	        	<br>
	        	<label>Género</label><br>
	        	
	        	<input class="genero" id="sexo" type="radio" name="genero" value="Masculino">&nbsp;Masculino&nbsp;&nbsp;
                <input class="genero" id="sexo" type="radio" name="genero" value="Femenino">&nbsp;Femenino
	        	<br>
	        	<br>
	        	
	        	<input class="botonGeneralCentrado" type="submit" id="addNew" value="REGISTRAR">
	     </form>
      </div>
  </main><!-- FIN DE CUERPO DE PAGINA  -->

 <script>
	$(document).ready(function() {
		$(document).delegate('#addNew', 'click', function(event) {
				event.preventDefault();
				var nombre = $('#nombre').val();
				var contrasenia = $('#contrasenia').val();
				var correo = $('#correo').val();
				var sexo = $('#sexo').val();
				var fechaNacimiento = $('#fechaNacimiento').val();
				var telefono = $('#telefono').val();
				var direccion = $('#direccion').val();
				var idLocalidad = $('#idLocalidad').val();
				//var habilitado = 1;
				var puntajeBeneficio = 0;
				var idRol = 1; 
				
				console.log(nombre);
				console.log(contrasenia);
				console.log(correo);
				console.log(sexo);
				console.log(fechaNacimiento);
				console.log(telefono);
				console.log(direccion);
				console.log(idLocalidad);
				
				var formData = new FormData();
				var objArr = [];

				objArr.push({"nombre": nombre, "contrasenia": contrasenia, "correo": correo, "sexo": sexo, 
				"fechaNacimiento": fechaNacimiento, "telefono": telefono, "direccion": direccion,
				"idLocalidad": idLocalidad, "puntajeBeneficio": puntajeBeneficio, "idRol": idRol});
				console.log(objArr);

				formData.append('usuario', JSON.stringify( objArr ));
				console.log(formData);

				$.ajax({
					type: "POST",
					//contentType: "application/json; charset=utf-8",
					url: "http://localhost:8080/api/usuario",
					//data: JSON.stringify({"nombre": nombre, "contrasenia": contrasenia, "correo": correo, "sexo": sexo, "fechaNacimiento": fechaNacimiento, "telefono": telefono, "dirrecion": dirrecion, "idLocalidad": idLocalidad}),
					data: formData,
					cache: false,
					processData:false,
					contentType:false,
					success: function (result) {
						$.alert({
							title: 'OK',
							content: 'El usuario ha sido registrado!',
						});
						setTimeout(
							function () {
								window.location.href = "perfilUsuario.html";
							}, 2000);
					},
					error: function (xhr, exception) {
						if (xhr.status === 0)
							alert('Error : ' + xhr.status + 'You are not connected.');
						else if (xhr.status == "409") {
							$.alert({
								title: 'Error',
								content: 'El nombre de usuario o correo ya existe!',
							});
						}
						else if (xhr.status == "404")
							alert('Error : ' + xhr.status + '\nPage note found');
						else if (xhr.status == "500")
							alert('Internal Server Error [500].');
						else if (exception === 'parsererror')
							alert('Error : ' + xhr.status + '\nImpossible to parse result.');
						else if (exception === 'timeout')
							alert('Error : ' + xhr.status + '\nRequest timeout.');
						else
							alert('Error .\n' + xhr.responseText);
					}
				});
		});
	});
	</script>       
          

    <footer ><!-- Footer -->
            <div class="redesolmedo">   
                <div class="redes">
                     <div class="contenedor-redes">
                   	 <img src="img/facebook.png">
                    </div>
                    <div class="contenedor-redes">
                   	 <img src="img/instagram.png">
                    </div>
                    <div class="contenedor-redes">
                   	 <img src="img/youtube.png">
                    </div>
                	<div class="contenedor-redes">
                    	<img src="img/twitter.png">
                    </div>
                    <div class="contenedor-redes">
                    	<img src="img/whatsapp.png">
                    </div>
                </div>
            </div>

            <div class="copyright">
                Desarrollado por CODETEAM para CDOLMEDO &copy; Riobamba 2020
            </div>
        </footer><!-- FIN footer-->

 <!-- Botstrap -->      
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script> 

</body>
</html>